#include <iostream>

#include "Encryption.h"

using namespace std;

void printTextOrCipher(string str, unsigned char textOrCipher[]) {
	cout << str;
	for (int i = 0; i < 16; i++) {
		cout << hex << (int) (textOrCipher[i]) << " ";
	}
}

int main() {

//	Object creation of encryption class
	Encryption encryption;
	unsigned char encryptedCipherText[16];

	unsigned char inputMessage[] = { 0x6B, 0xC1, 0xBE, 0xE2, 0x2E, 0x40, 0x9F,
			0x96, 0xE9, 0x3D, 0x7E, 0x11, 0x73, 0x93, 0x17, 0x2A }; // input as per course pdf

	unsigned char inputKey[] = { 0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6,
			0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C }; // inputKey as per course pdf

	/* 2 more examples added to test the algorithm below */

//	unsigned char inputMessage[] = { 0xF6,0x9F,0x24,0x45,0xDF,0x4F,0x9B,0x17,0xAD,0x2B,0x41,0x7B,0xE6,0x6C,0x37,0x10};
//	unsigned char inputKey[] = { 0x2B,0x7E,0x15,0x16,0x28,0xAE,0xD2,0xA6,0xAB,0xF7,0x15,0x88,0x09,0xCF,0x4F,0x3C};
//
//	unsigned char inputMessage[] = { 0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
//	unsigned char inputKey[] = { 0xAB,0xCD,0xEF,0x79,0x89,0x39,0x02,0x93,0xFE,0xDC,0xBA,0x90,0x59,0x80,0x03,0x31};

	encryption.initKeyForExpansion(inputKey); // Initializing the inputKey for the key expansion

	printTextOrCipher("inputMessage : ", inputMessage);
	//Encrypt the inputMessage
	encryption.encrypt(inputMessage, encryptedCipherText);
	cout << endl;
	printTextOrCipher("encryptedCipherText : ", encryptedCipherText);

	return 0;
}

